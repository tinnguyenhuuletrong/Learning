(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1067:function(e,t){},1076:function(e,t){},1078:function(e,t){},1107:function(e,t){},1121:function(e,t){},1158:function(e,t){},1319:function(e,t,n){},1321:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),c=n(532),o=n.n(c),s=(n(542),n(536)),u=n(21),i=n.n(u),l=n(64),m=n(53),f=n(533),p=n.n(f),b=null;function d(e){var t=e.commands,n=Object(a.useState)(!!b),r=Object(m.a)(n,2),c=r[0],o=r[1],s=Object(a.useState)(null),u=Object(m.a)(s,2),f=u[0],d=u[1];function h(){return(h=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=4;break}console.log("IPFS already started"),e.next=26;break;case 4:if(!window.ipfs||!window.ipfs.enable){e.next=11;break}return console.log("Found window.ipfs"),e.next=8,window.ipfs.enable({commands:t});case 8:b=e.sent,e.next=26;break;case 11:return e.prev=11,console.time("IPFS Started"),e.next=15,w(p.a,{config:{Addresses:{Swarm:["/dns4/ws-star.discovery.libp2p.io/tcp/443/wss/p2p-websocket-star"]}},EXPERIMENTAL:{pubsub:!0}});case 15:b=e.sent,console.timeEnd("IPFS Started"),window.ipfs=b,window.Buffer=b.types.Buffer,e.next=26;break;case 21:e.prev=21,e.t0=e.catch(11),console.error("IPFS init error:",e.t0),b=null,d(e.t0);case 26:o(!!b);case 27:case"end":return e.stop()}},e,null,[[11,21]])}))).apply(this,arguments)}return Object(a.useEffect)(function(){return function(){h.apply(this,arguments)}(),function(){b&&b.stop&&(console.log("Stopping IPFS"),b.stop(),o(!1))}},[]),{ipfs:b,isIpfsReady:c,ipfsInitError:f}}function w(e,t){return new Promise(function(n,a){var r=new e(t);r.once("ready",function(){return n(r)}),r.once("error",function(e){return a(e)})})}var h=n(534),g=n.n(h);function v(e,t,n){var r=Object(a.useState)(null),c=Object(m.a)(r,2),o=c[0],s=c[1];return Object(a.useEffect)(function(){!function(e,t,n,a){E.apply(this,arguments)}(e,t,n,s)},[e,t,n]),o}function E(){return(E=Object(l.a)(i.a.mark(function e(t,n,a,r){var c,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return console.log("Call ipfs.".concat(n)),c=g.a.get(t,n),e.next=6,c(a);case 6:o=e.sent,console.log("Result ipfs.".concat(n),o),r(o);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N=n(535),y=n.n(N),S=(n(1319),function(){return r.a.createElement("div",{id:"snackbar"},"Some text some message..")}),k=null;window.showMessage=function(e){var t=document.getElementById("snackbar");t.innerHTML=e,t.className="show",k&&clearTimeout(k),k=setTimeout(function(){t.className=t.className.replace("show",""),k=null},3e3)};var O=new(n(11).EventEmitter),j={};function x(e){try{return JSON.parse(e)}catch(t){return null}}var I=function(e){var t=e.children;return r.a.createElement("h2",{className:"f5 ma0 pb2 tracked aqua fw4 montserrat"},t)},M=function(e){return e?r.a.createElement("section",{className:"bg-snow mw8 center mt5"},r.a.createElement("h1",{className:"f3 fw4 ma0 pv3 aqua montserrat tc"},"Connected to IPFS"),r.a.createElement("div",{className:"pa4"},["id","agentVersion","addresses"].map(function(t){return r.a.createElement("div",{className:"mb4",key:t},r.a.createElement(I,null,t),r.a.createElement("div",{className:"bg-white pa2 br2 truncate monospace"},e[t]))}))):null},C=function(e){var t=e.peers;return t?r.a.createElement("section",{className:"bg-snow mw8 center mt5"},r.a.createElement("h1",{className:"f3 fw4 ma0 pv3 aqua montserrat tc"},"Peers (",t.length,")"),r.a.createElement("div",{className:"pa3"},t.map(function(e,t){return r.a.createElement("li",{className:"bg-white pa2 br2 truncate monospace",key:t},e)}))):null},P=function(e){var t=e.ipfs,n=Object(a.useState)(""),c=Object(m.a)(n,2),o=c[0],s=c[1],u=function(){var e=Object(l.a)(i.a.mark(function e(n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",console.error("No multiaddr was inserted."));case 2:t.swarm.connect(n).then(function(){window.showMessage("Successfully connected to peer.")}).catch(function(e){console.error(e),window.showMessage("An error occurred when connecting to the peer.")});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("section",{className:"bg-snow mw8 center mt5"},r.a.createElement("h1",{className:"f3 fw4 ma0 pv3 aqua montserrat tc"},"Connect To"),r.a.createElement("div",{className:"pa3"},r.a.createElement(I,null,"Multiaddr"),r.a.createElement("div",{className:"bg-white pa2 br2"},r.a.createElement("input",{id:"multiaddr-input",type:"text",placeholder:"Multiaddr",value:o,style:{width:"100%"},onChange:function(e){s(e.target.value)}})),r.a.createElement("center",null,r.a.createElement("button",{id:"peer-btn",style:{margin:10},onClick:function(e){u(o)}},"Connect"))))},T=function(e){var t=e.ipfs,n=e.defaultTopic,c=void 0===n?["#general"]:n,o=Object(a.useState)(""),s=Object(m.a)(o,2),u=s[0],f=s[1],p=Object(a.useState)([]),b=Object(m.a)(p,2),d=b[0],w=b[1],h=function(e){return function(t){O.emit("message",{topic:e,msg:t})}},g=function(){var e=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.pubsub.ls().then(function(e){w(e)}).catch(function(e){return window.showMessage("An error occurred when connecting to the peer.")});case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(l.a)(i.a.mark(function e(n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",console.error("No topic."));case 2:if(!j[n]){e.next=4;break}return e.abrupt("return",console.error("Already subcrible topic"));case 4:a=h(n),t.pubsub.subscribe(n,a).then(function(){window.showMessage("Successfully"),j[n]=a,g()}).catch(function(e){console.error(e),window.showMessage("An error occurred.")});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(l.a)(i.a.mark(function e(n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",console.error("No multiaddr was inserted."));case 2:if(j[n]){e.next=4;break}return e.abrupt("return",console.error("Not yet subcrible to topic"));case 4:t.pubsub.unsubscribe(n,j[n]).then(function(){window.showMessage("Successfully"),delete j[n],g()}).catch(function(e){console.error(e),window.showMessage("An error occurred.")});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)(function(e){g(),c.forEach(function(e){return v(e)})},[t]),r.a.createElement("section",{className:"bg-snow mw8 center mt5"},r.a.createElement("h1",{className:"f3 fw4 ma0 pv3 aqua montserrat tc"},"Subcrible"),r.a.createElement("div",{className:"pa3"},r.a.createElement(I,null,"Topics (",d.length,")"),d.map(function(e,t){return r.a.createElement("li",{className:"bg-white pa2 br2 truncate monospace",key:t},e.toString())})),r.a.createElement("div",{className:"pa3"},r.a.createElement(I,null,"Add & Remove"),r.a.createElement("div",{className:"bg-white pa2 br2"},r.a.createElement("input",{id:"multiaddr-input",type:"text",placeholder:"Topic Name",value:u,style:{width:"100%"},onChange:function(e){f(e.target.value)}})),r.a.createElement("center",null,r.a.createElement("button",{style:{margin:10},onClick:function(e){v(u)}},"Subcrible"),r.a.createElement("button",{style:{margin:10},onClick:function(e){E(u)}},"UnSubcrible"))))},A=function(e){var t=e.ipfs,n=e.defaultTopicName,c=void 0===n?"#general":n,o=Object(a.useState)(c),u=Object(m.a)(o,2),f=u[0],p=u[1],b=Object(a.useState)(""),d=Object(m.a)(b,2),w=d[0],h=d[1],g=Object(a.useState)([]),v=Object(m.a)(g,2),E=v[0],N=v[1],y=function(){var e=Object(l.a)(i.a.mark(function e(n){var a,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.topic,r=n.message,j[a]){e.next=3;break}return e.abrupt("return",console.error("Not yet subcrible to topic"));case 3:t.pubsub.publish(a,t.types.Buffer.from(r)).then(function(){}).catch(function(e){console.error(e),window.showMessage("An error occurred.")});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)(function(e){var t=function(e){var t=e.topic,n=e.msg,a=n.data.toString(),r={topic:t,rawMsg:a,msg:x(a)};console.log(t," -> ",n),N([r].concat(Object(s.a)(E)))};return O.on("message",t),function(e){return O.off("message",t)}},[t,E]),r.a.createElement("section",{className:"bg-snow mw8 center mt5"},r.a.createElement("h1",{className:"f3 fw4 ma0 pv3 aqua montserrat tc"},"Publish"),r.a.createElement("div",{className:"pa3"},r.a.createElement(I,null,"Send To Topic"),r.a.createElement("div",{className:"bg-white pa2 br2"},r.a.createElement("input",{id:"multiaddr-input",type:"text",placeholder:"Topic Name",value:f,style:{width:"50%"},onChange:function(e){p(e.target.value)}})),r.a.createElement(I,null,"With Message"),r.a.createElement("div",{className:"bg-white pa2 br2"},r.a.createElement("input",{id:"multiaddr-input",type:"text",placeholder:"Content",value:w,style:{width:"100%"},onChange:function(e){h(e.target.value)}})),r.a.createElement("center",null,r.a.createElement("button",{style:{margin:10},onClick:function(e){y({topic:f,message:w})}},"Send")),r.a.createElement(I,null,"Received messages (",E.length,")"),E.map(function(e,t){return r.a.createElement("li",{className:"bg-white pa2 br2 truncate monospace",key:t},"".concat(e.topic.toString()," - ").concat(e.rawMsg))})))},B=function(){var e=d({commands:["id"]}),t=e.ipfs,n=e.ipfsInitError,c=v(t,"id"),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=Object(a.useState)([]),r=Object(m.a)(n,2),c=r[0],o=r[1];return Object(a.useEffect)(function(){var n=setInterval(Object(l.a)(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.swarm.peers();case 4:n=t.sent,o(n.map(function(e){return e.addr.toString()}));case 6:case"end":return t.stop()}},t)})),t);return function(e){return clearInterval(n)}},[e]),c}(t);return r.a.createElement("div",{className:"sans-serif"},r.a.createElement("header",{className:"flex items-center pa3 bg-navy bb bw3 b--aqua"},r.a.createElement("a",{href:"https://ipfs.io",title:"home"},r.a.createElement("img",{alt:"IPFS logo",src:y.a,style:{height:50},className:"v-top"})),r.a.createElement("h1",{className:"flex-auto ma0 tr f3 fw2 montserrat aqua"},"IPFS React")),r.a.createElement("main",null,n&&r.a.createElement("div",{className:"bg-yellow pa4 mw7 center mv4 white"},"Error: ",n.message||n),c&&r.a.createElement(M,c),Boolean(t)&&r.a.createElement(T,{ipfs:t}),Boolean(t)&&r.a.createElement(A,{ipfs:t}),Boolean(t)&&r.a.createElement(P,{ipfs:t}),Boolean(o&&o.length)&&r.a.createElement(C,{peers:o})),r.a.createElement(S,null))};o.a.render(r.a.createElement(B,null),document.getElementById("root"))},374:function(e,t){},535:function(e,t,n){e.exports=n.p+"static/media/ipfs-logo.4831bd1a.svg"},537:function(e,t,n){e.exports=n(1321)},542:function(e,t,n){},634:function(e,t){},636:function(e,t){},709:function(e,t){},722:function(e,t){},860:function(e,t){},888:function(e,t){},910:function(e,t){},912:function(e,t){},923:function(e,t){},998:function(e,t){}},[[537,2,1]]]);
//# sourceMappingURL=main.50d53eb7.chunk.js.map