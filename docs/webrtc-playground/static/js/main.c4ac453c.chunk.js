(window["webpackJsonpwebrtc-playground"]=window["webpackJsonpwebrtc-playground"]||[]).push([[0],{26:function(e,t,n){e.exports=n(56)},45:function(e,t){},47:function(e,t){},56:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"ESTEP",function(){return d}),n.d(a,"ECLIENT_MODE",function(){return f}),n.d(a,"EACTION",function(){return p});var r=n(0),c=n.n(r),o=n(25),l=n.n(o),s=(n(31),n(1)),i=n(7),u=n(10),m=n(11),E=n.n(m),d={CHOICE_MODE:"CHOICE_MODE",NOT_CONNECT:"NOT_CONNECT",CONNECTED:"CONNECTED"},f={HOST:"HOST",PEER:"PEER"},p={reset:"reset",setAppStep:"setAppStep",setAppMode:"setAppMode",updateConenction:"updateConenction",updateWebRTCSupport:"updateWebRTCSupport"};function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach(function(t){Object(i.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var v={supportWebRTC:!1,appStep:d.CHOICE_MODE,mode:"",connection:null,eventSource:new u.EventEmitter},N=function(e){return function(t,n){var a=e(t,n);return window.store=a,a}}(function(e,t){switch(console.log("action",t),t.type){case p.reset:return O({},v,{eventSource:new u.EventEmitter,supportWebRTC:E.a.isWebRTCSupported});case p.updateWebRTCSupport:return O({},e,{supportWebRTC:t.value});case p.setAppMode:return O({},e,{mode:t.value});case p.setAppStep:return O({},e,{appStep:t.value});case p.updateConenction:return O({},e,{connection:t.value});default:return e}}),j=Object(r.createContext)(),g=function(e){var t=e.children;return c.a.createElement(j.Provider,{value:Object(r.useReducer)(N,v)},t)},C=function(){return Object(r.useContext)(j)},y=a,S=function(e){var t=e.expectedAppStep,n=e.children,a=C(),r=Object(s.a)(a,1)[0].appStep,o=Array.isArray(t)?t:[t];return c.a.createElement(c.a.Fragment,null,o.includes(r)?n:null)},T=function(e){e.defaultIndex,e.tabs;var t=C(),n=Object(s.a)(t,2),a=n[0],o=a.appStep,l=a.mode,i=a.connection,u=n[1],m=Object(r.useCallback)(function(e){u({type:y.EACTION.setAppMode,value:e}),u({type:y.EACTION.setAppStep,value:y.ESTEP.NOT_CONNECT})},[u]),E=Object(r.useCallback)(function(){i&&i.destroy&&i.destroy(),u({type:y.EACTION.reset})},[u,i]),d=o===y.ESTEP.CHOICE_MODE?{disabled:!1}:{disabled:!0};return c.a.createElement("div",{className:"columns is-multiline"},c.a.createElement("div",{className:"column is-full"},c.a.createElement("fieldset",d,c.a.createElement("div",{className:"field is-grouped is-grouped-centered"},c.a.createElement("label",{className:"radio"},c.a.createElement("input",{type:"radio",checked:l===y.ECLIENT_MODE.HOST,onChange:function(e){return m(y.ECLIENT_MODE.HOST)}}),c.a.createElement("span",{style:{margin:5}},"Host")),c.a.createElement("label",{className:"radio"},c.a.createElement("input",{type:"radio",checked:l===y.ECLIENT_MODE.PEER,onChange:function(e){return m(y.ECLIENT_MODE.PEER)}}),c.a.createElement("span",{style:{margin:5}},"Peer"))))),c.a.createElement("div",{className:"column"},c.a.createElement("div",{className:"field is-grouped is-grouped-centered"},c.a.createElement(S,{expectedAppStep:[y.ESTEP.CONNECTED,y.ESTEP.NOT_CONNECT]},c.a.createElement("button",{className:"button is-warning",onClick:E},"Reset")))))},h=n(8),w=n(12),P=n.n(w),x=n(13),k=n(14),D=n.n(k),I=function(e){var t=e.onChange,n=Object(r.useState)('{\n    "trickle": true,\n    "config": {\n      "iceServers": [ { "urls": "stun:stun.l.google.com:19302" }, { "urls": "stun:global.stun.twilio.com:3478?transport=udp" } ]\n    }\n  }'),a=Object(s.a)(n,2),o=a[0],l=a[1],i=Object(r.useState)(!0),u=Object(s.a)(i,2),m=u[0],E=u[1];return Object(r.useEffect)(function(){t&&t(JSON.parse(o))},[]),c.a.createElement("div",{className:"field"},c.a.createElement("label",{className:"label"},"STUN/TURN config"," ",c.a.createElement("span",{class:["icon",m?"has-text-success":"has-text-danger"].join(" ")},c.a.createElement("i",{className:["fas",m?"fa-check":"fa-ban"].join(" ")}))),c.a.createElement("div",{className:["control"].join(" ")},c.a.createElement("textarea",{className:["textarea","is-small"].join(" "),defaultValue:o,onChange:function(e){try{l(e.target.value);var n=JSON.parse(e.target.value);t&&t(n),E(!0)}catch(a){E(!1)}}})))},A=function(e,t,n){Object(r.useEffect)(function(){if(e){var a=function(e){return t.emit("error",e)},r=function(){t.emit("connect"),n({type:y.EACTION.setAppStep,value:y.ESTEP.CONNECTED})},c=function(){t.emit("close"),n({type:y.EACTION.setAppStep,value:y.ESTEP.NOT_CONNECT})},o=function(e){return t.emit("data",e)};return e.on("error",a),e.on("connect",r),e.on("data",o),e.on("close",c),function(){e.off("error",a),e.off("connect",r),e.off("data",o),e.off("close",c)}}},[e,t])};function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(n,!0).forEach(function(t){Object(i.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _=function(e){var t=C(),n=Object(s.a)(t,2),a=n[0],o=a.appStep,l=a.mode,i=a.connection,u=a.eventSource,m=n[1],E=Object(r.useState)(1),d=Object(s.a)(E,2),f=d[0],p=d[1],b=Object(r.useReducer)(function(e,t){return[].concat(Object(h.a)(e),[t])},[]),O=Object(s.a)(b,2),v=O[0],N=O[1],j=Object(r.useState)(""),g=Object(s.a)(j,2),S=g[0],T=g[1],w=Object(r.useReducer)(function(e,t){return M({},e,{},t)},{}),k=Object(s.a)(w,2),R=k[0],_=k[1],H=Object(r.useMemo)(function(){return{disabled:!(o===y.ESTEP.NOT_CONNECT&&l===y.ECLIENT_MODE.HOST)}},[o,l]);A(i,u,m);var W=Object(r.useCallback)(function(){console.log("Create peer with",R);var e=new P.a(M({initiator:!0},R));e.on("signal",function(e){N(e)}),p(2),m({type:y.EACTION.updateConenction,value:e})},[m,R]),J=Object(r.useCallback)(function(){try{console.log("submit answer",S);var e=JSON.parse(S);if(!Array.isArray(e))throw new Error("Input signal must be aray");e.forEach(function(e){return i.signal(e)})}catch(t){console.error(t)}},[S,i]),L=Object(r.useCallback)(function(){var e;e=JSON.stringify(v),D()(e),Object(x.toast)({message:"copied",type:"is-info",animate:{in:"fadeIn",out:"fadeOut"}})},[v]),F=Object(r.useCallback)(function(e){_(e)},[_]);return c.a.createElement("fieldset",H,c.a.createElement(I,{onChange:F}),c.a.createElement("div",{className:"field"},c.a.createElement("label",{className:"label"},"Host Signal Data"," ",c.a.createElement("a",{className:"button is-rounded is-small",onClick:L},c.a.createElement("i",{className:"far fa-clipboard"}))),c.a.createElement("div",{className:["control",v?"":"is-loading"].join(" ")},c.a.createElement("textarea",{className:["textarea","is-small"].join(" "),readOnly:!0,value:JSON.stringify(v)}))),1===f&&c.a.createElement("div",{className:"field"},c.a.createElement("button",{className:"button is-primary",onClick:W},"Generate")),f>=2&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"field"},c.a.createElement("label",{className:"label"},"Answer"),c.a.createElement("div",{className:["control"].join(" ")},c.a.createElement("textarea",{className:["textarea","is-small"].join(" "),value:S,onChange:function(e){return T(e.target.value)}}))),c.a.createElement("div",{className:"field"},c.a.createElement("button",{className:"button is-primary",onClick:J},"Connect"))))};function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach(function(t){Object(i.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var J=function(e){var t=C(),n=Object(s.a)(t,2),a=n[0],o=a.appStep,l=a.mode,i=a.connection,u=a.eventSource,m=n[1],E=Object(r.useState)(1),d=Object(s.a)(E,2),f=d[0],p=d[1],b=Object(r.useState)(""),O=Object(s.a)(b,2),v=O[0],N=O[1],j=Object(r.useReducer)(function(e,t){return[].concat(Object(h.a)(e),[t])},[]),g=Object(s.a)(j,2),S=g[0],T=g[1],w=Object(r.useReducer)(function(e,t){return W({},e,{},t)},{}),k=Object(s.a)(w,2),R=k[0],M=k[1],_=Object(r.useMemo)(function(){return{disabled:!(o===y.ESTEP.NOT_CONNECT&&l===y.ECLIENT_MODE.PEER)}},[o,l]);A(i,u,m);var H=Object(r.useCallback)(function(){console.log("Create peer with",R),console.log("begin connect ",v);var e=new P.a(W({initiator:!1},R));e.on("signal",function(e){T(e)});try{var t=JSON.parse(v);if(!Array.isArray(t))throw new Error("Input signal must be aray");t.forEach(function(t){return e.signal(t)}),p(2),m({type:y.EACTION.updateConenction,value:e})}catch(n){console.error(n)}},[v,T,p,m,R]),J=Object(r.useCallback)(function(){var e;e=JSON.stringify(S),D()(e),Object(x.toast)({message:"copied",type:"is-info",animate:{in:"fadeIn",out:"fadeOut"}})},[S]),L=Object(r.useCallback)(function(e){M(e)},[M]);return c.a.createElement("fieldset",_,c.a.createElement(I,{onChange:L}),c.a.createElement("div",{className:"field"},c.a.createElement("label",{className:"label"},"SignalData from Host"),c.a.createElement("div",{className:["control"].join(" ")},c.a.createElement("textarea",{className:["textarea","is-small"].join(" "),value:v,onChange:function(e){return N(e.target.value)}}))),1===f&&c.a.createElement("div",{className:"field"},c.a.createElement("button",{className:"button is-primary",onClick:H},"Connect")),2===f&&c.a.createElement("div",{className:"field"},c.a.createElement("label",{className:"label"},"Answer To Host"," ",c.a.createElement("a",{className:"button is-rounded is-small",onClick:J},c.a.createElement("i",{className:"far fa-clipboard"}))),c.a.createElement("div",{className:["control"].join(" ")},c.a.createElement("textarea",{className:["textarea","is-small"].join(" "),readOnly:!0,value:JSON.stringify(S)}))))},L={connecting:"is-link",connected:"is-primary",error:"is-danger",disconnected:"is-warning"},F=function(e){e.defaultIndex,e.tabs;var t=C(),n=Object(s.a)(t,1)[0].eventSource,a=Object(r.useState)("connecting"),o=Object(s.a)(a,2),l=o[0],i=o[1];return Object(r.useEffect)(function(){var e=function(e){return i(e)};n.on("connect",function(t){return e("connected")}),n.on("close",function(t){return e("disconnected")}),n.on("error",function(t){return e("error")})},[n]),c.a.createElement("article",{className:["message",L[l]].join(" ")},c.a.createElement("div",{className:"message-body"},c.a.createElement("p",{className:"is-capitalized"},l)))},z=function(e){e.defaultIndex,e.tabs;var t=C(),n=Object(s.a)(t,1)[0].eventSource,a=Object(r.useState)([]),o=Object(s.a)(a,2),l=o[0],i=o[1];return Object(r.useEffect)(function(){var e=function(e){return function(){i([].concat(Object(h.a)(l),[{_time:new Date,content:e}]))}},t=e("connected"),a=e("error"),r=e("disconnected"),c=function(t){return e("Recv -> ".concat(t))()};return n.on("connect",t),n.on("error",a),n.on("data",c),n.on("close",r),n.on("action-send-text",function(t){return e("Send -> ".concat(t))()}),function(){n.off("connect",t),n.off("error",a),n.off("data",c),n.off("close",r)}},[l,i,n]),c.a.createElement("div",{className:"column is-full"},c.a.createElement("div",{className:"container has-background-grey-lighter is-size-7",style:{minHeight:"50vh",maxHeight:"50vh",overflowY:"auto",padding:"5px 10px"}},l.map(function(e,t){var n=e.content,a=e._time;return c.a.createElement("p",{key:t},String(a)," - ",String(n))})))},B=function(e){e.defaultIndex,e.tabs;var t=C(),n=Object(s.a)(t,1)[0],a=n.eventSource,o=n.connection,l=Object(r.useState)(!1),i=Object(s.a)(l,2),u=i[0],m=i[1],E=Object(r.useState)([]),d=Object(s.a)(E,2),f=d[0],p=d[1];Object(r.useEffect)(function(){var e=function(){return m(!0)},t=function(){return m(!1)};return a.on("connect",e),a.on("close",t),function(){a.off("connect",e),a.off("close",t)}},[a,m]);var b=Object(r.useCallback)(function(e){return p(e)},[p]),O=Object(r.useCallback)(function(){o.send(f),a.emit("action-send-text",f),b("")},[f,o,a,b]);return c.a.createElement("fieldset",{disabled:!u},c.a.createElement("div",{className:"columns"},c.a.createElement("div",{className:"column is-11"},c.a.createElement("input",{className:"input",type:"text",placeholder:"message to send",value:f,onChange:function(e){return b(e.target.value)},onKeyPress:function(e){e||(e=window.event);var t=e.keyCode||e.which;if("13"===String(t))return O(e.target.value),!1}})),c.a.createElement("div",{className:"column"},c.a.createElement("button",{className:"button is-info",onClick:O},"Send"))))},U=function(e){e.expectedMode;var t=e.children,n=C(),a=Object(s.a)(n,2),o=a[0].supportWebRTC,l=a[1],i=Object(r.useState)(!0),u=Object(s.a)(i,2),m=u[0],d=u[1];return Object(r.useEffect)(function(){E.a.load(function(){l({type:y.EACTION.updateWebRTCSupport,value:E.a.isWebRTCSupported}),d(!1)})},[l]),c.a.createElement(c.a.Fragment,null,m?null:o?t:c.a.createElement("article",{class:"message is-danger"},c.a.createElement("div",{class:"message-body"},"Browser don't support WebRTC")))},G=function(e){var t=e.expectedMode,n=e.children,a=C(),r=Object(s.a)(a,1)[0].mode;return c.a.createElement(c.a.Fragment,null,t===r?n:null)};var K=function(){return c.a.createElement(g,null,c.a.createElement("section",{className:"section "},c.a.createElement("div",{className:"container"},c.a.createElement("section",{className:"hero"},c.a.createElement("div",{className:"hero-body"},c.a.createElement("div",{className:"container"},c.a.createElement("h1",{className:"title"},"Web RTC Playground")))),c.a.createElement(U,null,c.a.createElement("p",{className:"has-text-centered is-size-3"},"Start here !"),c.a.createElement("div",{className:"column"},c.a.createElement("div",{className:"box"},c.a.createElement(T,null))),c.a.createElement(G,{expectedMode:y.ECLIENT_MODE.HOST},c.a.createElement("div",{className:"column"},c.a.createElement("div",{className:"box"},c.a.createElement(_,null)))),c.a.createElement(G,{expectedMode:y.ECLIENT_MODE.PEER},c.a.createElement("div",{className:"column"},c.a.createElement("div",{className:"box"},c.a.createElement(J,null)))),c.a.createElement("div",{className:"column"},c.a.createElement(F,null)),c.a.createElement("div",{className:"column is-multiline"},c.a.createElement("div",{className:"box"},c.a.createElement(z,null)),c.a.createElement("div",{className:"box"},c.a.createElement(B,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,1,2]]]);
//# sourceMappingURL=main.c4ac453c.chunk.js.map