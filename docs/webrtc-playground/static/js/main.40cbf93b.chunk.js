(window["webpackJsonpwebrtc-playground"]=window["webpackJsonpwebrtc-playground"]||[]).push([[0],{26:function(e,t,a){e.exports=a(56)},45:function(e,t){},47:function(e,t){},56:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"ESTEP",function(){return d}),a.d(n,"ECLIENT_MODE",function(){return f}),a.d(n,"EACTION",function(){return p});var c=a(0),r=a.n(c),o=a(24),l=a.n(o),s=(a(31),a(1)),i=a(25),u=a(9),m=a(10),E=a.n(m),d={CHOICE_MODE:"CHOICE_MODE",NOT_CONNECT:"NOT_CONNECT",CONNECTED:"CONNECTED"},f={HOST:"HOST",PEER:"PEER"},p={reset:"reset",setAppStep:"setAppStep",setAppMode:"setAppMode",updateConenction:"updateConenction",updateWebRTCSupport:"updateWebRTCSupport"};function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(a,!0).forEach(function(t){Object(i.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var N={supportWebRTC:!1,appStep:d.CHOICE_MODE,mode:"",connection:null,eventSource:new u.EventEmitter},v=function(e){return function(t,a){var n=e(t,a);return window.store=n,n}}(function(e,t){switch(console.log("action",t),t.type){case p.reset:return O({},N,{eventSource:new u.EventEmitter,supportWebRTC:E.a.isWebRTCSupported});case p.updateWebRTCSupport:return O({},e,{supportWebRTC:t.value});case p.setAppMode:return O({},e,{mode:t.value});case p.setAppStep:return O({},e,{appStep:t.value});case p.updateConenction:return O({},e,{connection:t.value});default:return e}}),C=Object(c.createContext)(),j=function(e){var t=e.children;return r.a.createElement(C.Provider,{value:Object(c.useReducer)(v,N)},t)},g=function(){return Object(c.useContext)(C)},S=n,T=function(e){var t=e.expectedAppStep,a=e.children,n=g(),c=Object(s.a)(n,1)[0].appStep,o=Array.isArray(t)?t:[t];return r.a.createElement(r.a.Fragment,null,o.includes(c)?a:null)},y=function(e){e.defaultIndex,e.tabs;var t=g(),a=Object(s.a)(t,2),n=a[0],o=n.appStep,l=n.mode,i=n.connection,u=a[1],m=Object(c.useCallback)(function(e){u({type:S.EACTION.setAppMode,value:e}),u({type:S.EACTION.setAppStep,value:S.ESTEP.NOT_CONNECT})},[u]),E=Object(c.useCallback)(function(){i&&i.destroy&&i.destroy(),u({type:S.EACTION.reset})},[u,i]),d=o===S.ESTEP.CHOICE_MODE?{disabled:!1}:{disabled:!0};return r.a.createElement("div",{className:"columns is-multiline"},r.a.createElement("div",{className:"column is-full"},r.a.createElement("fieldset",d,r.a.createElement("div",{className:"field is-grouped is-grouped-centered"},r.a.createElement("label",{className:"radio"},r.a.createElement("input",{type:"radio",checked:l===S.ECLIENT_MODE.HOST,onChange:function(e){return m(S.ECLIENT_MODE.HOST)}}),r.a.createElement("span",{style:{margin:5}},"Host")),r.a.createElement("label",{className:"radio"},r.a.createElement("input",{type:"radio",checked:l===S.ECLIENT_MODE.PEER,onChange:function(e){return m(S.ECLIENT_MODE.PEER)}}),r.a.createElement("span",{style:{margin:5}},"Peer"))))),r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"field is-grouped is-grouped-centered"},r.a.createElement(T,{expectedAppStep:[S.ESTEP.CONNECTED,S.ESTEP.NOT_CONNECT]},r.a.createElement("button",{className:"button is-warning",onClick:E},"Reset")))))},h=a(7),w=a(11),x=a.n(w),I=a(12),A=a(13),k=a.n(A),P=function(e,t,a){Object(c.useEffect)(function(){if(e){var n=function(e){return t.emit("error",e)},c=function(){t.emit("connect"),a({type:S.EACTION.setAppStep,value:S.ESTEP.CONNECTED})},r=function(){t.emit("close"),a({type:S.EACTION.setAppStep,value:S.ESTEP.NOT_CONNECT})},o=function(e){return t.emit("data",e)};return e.on("error",n),e.on("connect",c),e.on("data",o),e.on("close",r),function(){e.off("error",n),e.off("connect",c),e.off("data",o),e.off("close",r)}}},[e,t])},D=function(e){var t=g(),a=Object(s.a)(t,2),n=a[0],o=n.appStep,l=n.mode,i=n.connection,u=n.eventSource,m=a[1],E=Object(c.useState)(1),d=Object(s.a)(E,2),f=d[0],p=d[1],b=Object(c.useReducer)(function(e,t){return[].concat(Object(h.a)(e),[t])},[]),O=Object(s.a)(b,2),N=O[0],v=O[1],C=Object(c.useState)(""),j=Object(s.a)(C,2),T=j[0],y=j[1],w=Object(c.useMemo)(function(){return{disabled:!(o===S.ESTEP.NOT_CONNECT&&l===S.ECLIENT_MODE.HOST)}},[o,l]);P(i,u,m);var A=Object(c.useCallback)(function(){var e=new x.a({initiator:!0});e.on("signal",function(e){v(e)}),p(2),m({type:S.EACTION.updateConenction,value:e})},[m]),D=Object(c.useCallback)(function(){try{console.log("submit answer",T);var e=JSON.parse(T);if(!Array.isArray(e))throw new Error("Input signal must be aray");e.forEach(function(e){return i.signal(e)})}catch(t){console.error(t)}},[T,i]),M=Object(c.useCallback)(function(){var e;e=JSON.stringify(N),k()(e),Object(I.toast)({message:"copied",type:"is-info",animate:{in:"fadeIn",out:"fadeOut"}})},[N]);return r.a.createElement("fieldset",w,r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Host Signal Data"," ",r.a.createElement("a",{className:"button is-rounded is-small",onClick:M},r.a.createElement("i",{className:"far fa-clipboard"}))),r.a.createElement("div",{className:["control",N?"":"is-loading"].join(" ")},r.a.createElement("textarea",{className:["textarea","is-small"].join(" "),readOnly:!0,value:JSON.stringify(N)}))),1===f&&r.a.createElement("div",{className:"field"},r.a.createElement("button",{className:"button is-primary",onClick:A},"Generate")),f>=2&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Answer"),r.a.createElement("div",{className:["control"].join(" ")},r.a.createElement("textarea",{className:["textarea","is-small"].join(" "),value:T,onChange:function(e){return y(e.target.value)}}))),r.a.createElement("div",{className:"field"},r.a.createElement("button",{className:"button is-primary",onClick:D},"Connect"))))},M=function(e){var t=g(),a=Object(s.a)(t,2),n=a[0],o=n.appStep,l=n.mode,i=n.connection,u=n.eventSource,m=a[1],E=Object(c.useState)(1),d=Object(s.a)(E,2),f=d[0],p=d[1],b=Object(c.useState)(""),O=Object(s.a)(b,2),N=O[0],v=O[1],C=Object(c.useReducer)(function(e,t){return[].concat(Object(h.a)(e),[t])},[]),j=Object(s.a)(C,2),T=j[0],y=j[1],w=Object(c.useMemo)(function(){return{disabled:!(o===S.ESTEP.NOT_CONNECT&&l===S.ECLIENT_MODE.PEER)}},[o,l]);P(i,u,m);var A=Object(c.useCallback)(function(){console.log("begin connect ",N);var e=new x.a({initiator:!1,trickle:!1});e.on("signal",function(e){y(e)});try{var t=JSON.parse(N);if(!Array.isArray(t))throw new Error("Input signal must be aray");t.forEach(function(t){return e.signal(t)}),p(2),m({type:S.EACTION.updateConenction,value:e})}catch(a){console.error(a)}},[N,y,p,m]),D=Object(c.useCallback)(function(){var e;e=JSON.stringify(T),k()(e),Object(I.toast)({message:"copied",type:"is-info",animate:{in:"fadeIn",out:"fadeOut"}})},[T]);return r.a.createElement("fieldset",w,r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"SignalData from Host"),r.a.createElement("div",{className:["control"].join(" ")},r.a.createElement("textarea",{className:["textarea","is-small"].join(" "),value:N,onChange:function(e){return v(e.target.value)}}))),1===f&&r.a.createElement("div",{className:"field"},r.a.createElement("button",{className:"button is-primary",onClick:A},"Connect")),2===f&&r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Answer To Host"," ",r.a.createElement("a",{className:"button is-rounded is-small",onClick:D},r.a.createElement("i",{className:"far fa-clipboard"}))),r.a.createElement("div",{className:["control"].join(" ")},r.a.createElement("textarea",{className:["textarea","is-small"].join(" "),readOnly:!0,value:JSON.stringify(T)}))))},R={connecting:"is-link",connected:"is-primary",error:"is-danger",disconnected:"is-warning"},_=function(e){e.defaultIndex,e.tabs;var t=g(),a=Object(s.a)(t,1)[0].eventSource,n=Object(c.useState)("connecting"),o=Object(s.a)(n,2),l=o[0],i=o[1];return Object(c.useEffect)(function(){var e=function(e){return i(e)};a.on("connect",function(t){return e("connected")}),a.on("close",function(t){return e("disconnected")}),a.on("error",function(t){return e("error")})},[a]),r.a.createElement("article",{className:["message",R[l]].join(" ")},r.a.createElement("div",{className:"message-body"},r.a.createElement("p",{className:"is-capitalized"},l)))},H=function(e){e.defaultIndex,e.tabs;var t=g(),a=Object(s.a)(t,1)[0].eventSource,n=Object(c.useState)([]),o=Object(s.a)(n,2),l=o[0],i=o[1];return Object(c.useEffect)(function(){var e=function(e){return function(){i([].concat(Object(h.a)(l),[{_time:new Date,content:e}]))}},t=e("connected"),n=e("error"),c=e("disconnected"),r=function(t){return e("Recv -> ".concat(t))()};return a.on("connect",t),a.on("error",n),a.on("data",r),a.on("close",c),a.on("action-send-text",function(t){return e("Send -> ".concat(t))()}),function(){a.off("connect",t),a.off("error",n),a.off("data",r),a.off("close",c)}},[l,i,a]),r.a.createElement("div",{className:"column is-full"},r.a.createElement("div",{className:"container has-background-grey-lighter is-size-7",style:{minHeight:"50vh",maxHeight:"50vh",overflowY:"auto",padding:"5px 10px"}},l.map(function(e,t){var a=e.content,n=e._time;return r.a.createElement("p",{key:t},String(n)," - ",String(a))})))},W=function(e){e.defaultIndex,e.tabs;var t=g(),a=Object(s.a)(t,1)[0],n=a.eventSource,o=a.connection,l=Object(c.useState)(!1),i=Object(s.a)(l,2),u=i[0],m=i[1],E=Object(c.useState)([]),d=Object(s.a)(E,2),f=d[0],p=d[1];Object(c.useEffect)(function(){var e=function(){return m(!0)},t=function(){return m(!1)};return n.on("connect",e),n.on("close",t),function(){n.off("connect",e),n.off("close",t)}},[n,m]);var b=Object(c.useCallback)(function(e){return p(e)},[p]),O=Object(c.useCallback)(function(){o.send(f),n.emit("action-send-text",f),b("")},[f,o,n,b]);return r.a.createElement("fieldset",{disabled:!u},r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column is-11"},r.a.createElement("input",{className:"input",type:"text",placeholder:"message to send",value:f,onChange:function(e){return b(e.target.value)},onKeyPress:function(e){e||(e=window.event);var t=e.keyCode||e.which;if("13"===String(t))return O(e.target.value),!1}})),r.a.createElement("div",{className:"column"},r.a.createElement("button",{className:"button is-info",onClick:O},"Send"))))},L=function(e){e.expectedMode;var t=e.children,a=g(),n=Object(s.a)(a,2),o=n[0].supportWebRTC,l=n[1],i=Object(c.useState)(!0),u=Object(s.a)(i,2),m=u[0],d=u[1];return Object(c.useEffect)(function(){E.a.load(function(){l({type:S.EACTION.updateWebRTCSupport,value:E.a.isWebRTCSupported}),d(!1)})},[l]),r.a.createElement(r.a.Fragment,null,m?null:o?t:r.a.createElement("article",{class:"message is-danger"},r.a.createElement("div",{class:"message-body"},"Browser don't support WebRTC")))},J=function(e){var t=e.expectedMode,a=e.children,n=g(),c=Object(s.a)(n,1)[0].mode;return r.a.createElement(r.a.Fragment,null,t===c?a:null)};var F=function(){return r.a.createElement(j,null,r.a.createElement("section",{className:"section "},r.a.createElement("div",{className:"container"},r.a.createElement("section",{className:"hero"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title"},"Web RTC Playground")))),r.a.createElement(L,null,r.a.createElement("p",{className:"has-text-centered is-size-3"},"Start here !"),r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"box"},r.a.createElement(y,null))),r.a.createElement(J,{expectedMode:S.ECLIENT_MODE.HOST},r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"box"},r.a.createElement(D,null)))),r.a.createElement(J,{expectedMode:S.ECLIENT_MODE.PEER},r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"box"},r.a.createElement(M,null)))),r.a.createElement("div",{className:"column"},r.a.createElement(_,null)),r.a.createElement("div",{className:"column is-multiline"},r.a.createElement("div",{className:"box"},r.a.createElement(H,null)),r.a.createElement("div",{className:"box"},r.a.createElement(W,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,1,2]]]);
//# sourceMappingURL=main.40cbf93b.chunk.js.map